<?xml version="1.0" encoding="UTF-8"?>
<openerp>
    <data>
    	
    	<record id="view_vhr_working_record_submit_form" model="ir.ui.view">
        <field name="name">vhr.working.record.submit.form</field>
            <field name="model">vhr.working.record</field>
            <field name="type">form</field>
            <field name="priority" eval="20"/>
            <field name="arch" type="xml">
                <form string="Note" version="7.0">
                	<separator string="You have to attach file before submit !"  class="vhr_human_resource_warning_message"  invisible="not context.get('is_require_data_for_submit')"/>
                	<group invisible="not context.get('is_require_data_for_submit')">
                		<field name="attachment_ids" required="context.get('is_require_data_for_submit')" nolabel='1' 
                			on_change="onchange_attachment_ids(attachment_ids)"
                			context="{'default_res_id':context.get('active_id'),'default_res_model':context.get('active_model'),
                			          'do_not_validate_read_attachment':'True'}">
                			<tree string="Attachment" version="7.0" editable="bottom">
                				<field name="datas" filename="datas_fname" trigger_on_change='True' string="File"/>
			                    <field name="datas_fname" options='{"file_download": 1, "field_data": "datas"}' invisible="1"/>
			                    <field name="create_date" invisible="1"/>
			                    <field name="write_uid" string="Updated by" invisible="1"/>
			                    <field name="res_id" invisible='1' options="{'save_readonly': True}"/>
			                    <field name="res_model" invisible='1' options="{'save_readonly': True}"/>
			                </tree>
                		</field>
                		<field name="attachment_count" invisible='1' widget="statinfo"/>
                		<field name="is_required_attachment" invisible='1'/>
                	</group>
                	
                    <separator string="Comment" colspan="4" required="context.get('required_comment',False)"/>
                    <footer>
                    	<!--For submit-approve -->
                    	<div invisible="0 if context.get('action') in ['submit','approve'] else 1">
                    		<div attrs="{'invisible': [('attachment_count','=',0),('is_required_attachment','=',True)]}">
	                    		<button name="execute_workflow"
	                                string="Submit"  one_click_button="True"
	                                type="object" icon="gtk-save"
	                                class="oe_highlight" context="{'ACTION_COMMENT': action_comment}"/>
		                        or
		                        <button string="Cancel" class="oe_link" special="cancel"/>
	                    	</div>
                    	
                    	</div>
                    	<div invisible="0 if context.get('action') in ['return','reject'] else 1">
                    		<!--Normal return/reject dont required attachment-->
                    		<div invisible="context.get('is_require_data_for_submit')">
                    			<button name="execute_workflow"
	                                string="Submit"  one_click_button="True"
	                                type="object" icon="gtk-save"
	                                class="oe_highlight" context="{'ACTION_COMMENT': action_comment}"/>
		                        or
		                        <button string="Cancel" class="oe_link" special="cancel"/>
                    		</div>
                    		
                    		<!--Return/reject required attachment-->
                    		<div invisible="not context.get('is_require_data_for_submit')">
                    			<div attrs="{'invisible': [('attachment_ids','=',[])]}">
	                    			<button name="execute_workflow"
		                                string="Submit"  one_click_button="True"
		                                type="object" icon="gtk-save"
		                                class="oe_highlight" context="{'ACTION_COMMENT': action_comment}"/>
			                        or
			                        <button string="Cancel" class="oe_link" special="cancel"/>
			                    </div>
                    		</div>
                    		
                    	</div>
                        
                    </footer>
                </form>
            </field>
        </record>
        
        <record id="view_vhr_working_record_confirm_form" model="ir.ui.view">
        <field name="name">vhr.working.record.confirm.form</field>
            <field name="model">vhr.working.record</field>
            <field name="type">form</field>
            <field name="priority" eval="21"/>
            <field name="arch" type="xml">
                <form string="Note" version="7.0">
                    <separator string="Are you sure you want to publish ?" colspan="4"/>
                    <footer>
                        <button name="execute_public_working_record"
                                string="OK"
                                type="object" icon="gtk-save"
                                class="oe_highlight"/>
                        or
                        <button string="Cancel" class="oe_link" special="cancel"/>
                    </footer>
                </form>
            </field>
        </record>
        
       	<record id="act_ir_attachment_2_vhr_working_record" model="ir.actions.act_window">
            <field name="res_model">ir.attachment</field>
            <field name="view_type">form</field>
            <field name="name">Attachment</field>
            <field name="view_id" eval="False"/>
            <field name="domain">[('res_model','=','vhr.working.record'),('res_id','=', active_id)]</field>
            <field name="context">{'search_default_res_id': [active_id], 'default_res_id': active_id,
            	                  'rule_for_tree_form':True,'attachment':False,'create':False,'edit':False}</field>
        	<field name="view_id" ref="document.view_document_file_tree"/>
            <field name="search_view_id" ref="base.view_attachment_search"/>
        </record>
        
        
    	<record id="view_vhr_working_record_form" model="ir.ui.view">
       		<field name="name">vhr.working.record.view.form</field>
       		<field name="model">vhr.working.record</field>
       		<field name="arch" type="xml">
       			<form string="Working Record" version="7.0" duplicate='false'>
       				<header>
       					<field name="state" widget="statusbar" 
       						options="{'save_readonly': True}"
							statusbar_visible="draft,new_hrbp,dept_hr,cb,finish"/>
       				</header>
       				<sheet>
	       				<div class="oe_right" name="buttons">
	       					
	                        <div class="oe_button_box" attrs="{'invisible': [('is_person_do_action','=',False)]}">
	                            <button string="Submit" name="open_window" type="object"
	                            	class="oe_stat_button bg_icon_green"
	                            	save_no_required='True'
		                            icon="fa-mail-forward"
									context="{'state': state,'action':'submit'}" states="draft"/>
								
								<button string="Approve" name="open_window" type="object"
									class="oe_stat_button bg_icon_green"
									save_no_required='True'
		                            icon="fa-mail-forward"
									context="{'action':'submit','state': state,'department_id_old':department_id_old,'department_id_new':department_id_new}" 
								    states="new_hrbp,dept_hr"/>
								
								<button string="Execute" name="open_window" type="object"
									save_no_required='True'
									class="oe_stat_button bg_icon_green"
		                            icon="fa-mail-forward"
									context="{'action':'submit','state': state,'department_id_old':department_id_old,'department_id_new':department_id_new}" 
								    states="cb,cb2"/>
							
								<button string="Return" name="open_window" type="object"
									save_no_required='True'
									class="oe_stat_button bg_icon_red"
		                            icon="fa-mail-reply"
									context="{'action':'return','state': state, 'required_comment':True}" 
								    states="new_hrbp,dept_hr"/>	
								
								<!--TODO:remove comment.
								              his button invisible depend on field is_able_to_do_action_reject and field is_person_do_action 
										      attrs="{'invisible': [('is_able_to_do_action_reject','=',False)]}"-->
								<button string="Reject" name="open_window" type="object"
									save_no_required='True'
									class="oe_stat_button bg_icon_red"
		                            icon="fa-times"
								    states="new_hrbp,dept_hr,cb,cb2,finish"
									context="{'action':'reject','state': state, 'required_comment':True}"/>
								
										
	                        </div>
	                        <div class="oe_button_box"
	                        	 attrs="{'invisible': ['|',('is_public','=',True),('state','not in',[False,'finish'])]}">
	                        	<button string="Execute" name="public_working_record" type="object"
	                        		save_no_required='True'
									class="oe_stat_button bg_icon_green"
	                        		confirm="Are you sure you want to publish ?"
		                            icon="fa-mail-forward"/>
	                        </div>
	                        <newline/>
	                        <div class="oe_right" name="buttons">
	                        	<button name="%(act_ir_attachment_2_vhr_working_record)d" 
		                            class="oe_stat_button" 
	                        		save_no_required='True'	
		                            icon="fa-paperclip" 
		                            type="action" attrs="{'invisible': [('attachment_count','=', 0)]}">
		                         	<field name="attachment_count" widget="statinfo" string="Attachments"/>
			                    </button>
	                        </div>
	                       
                        </div>
                        <group string="General Information" col="4">
                        	<group>
                        		<field name="requester_id" readonly ='1' 
                        		options="{'no_quick_create' : True, 'no_create':True, 'no_open': True,'save_readonly': True}"  />
                        	</group>
                        	<newline/>
       						<group>
       							<field name="employee_id" required='1'  
								options="{'no_quick_create' : True, 'no_create':True, 'no_open': True,'save_readonly': True}"
       							context="{'tree_view_ref':'vhr_human_resource.view_vhr_human_resource_mimimal_employee_tree'}"
       							on_change="onchange_employee_id(employee_id,company_id,is_change_employee_from_copy_data,context)"/>
       							<field name="effect_from" required='1' string="Effective Date" options="{'save_readonly': True}"
       							context="{'update_mask_data_in_create':update_mask_data_in_create,
       							          'job_level_old_id':job_level_person_id_old,
       									  'job_level_new_id':job_level_person_id_new,
       									}"
       						 	on_change="onchange_effect_from(effect_from,employee_id,company_id,contract_id,department_id_new,team_id_new,job_title_id_new,is_new,is_change_effect_from_copy_data,nearest_working_record_id,invisible_change_salary,context)"/>
       						 	<field name="company_id" required='1'
       						 	 domain="[('id', 'in', [])]"
       							 options="{'no_quick_create' : True, 'no_create':True, 'no_open': True,'save_readonly': True}"
	       						 context="{'employee_id': employee_id}" string="Entity"
       						     on_change="onchange_company_id(effect_from,employee_id,company_id,contract_id,department_id_new,team_id_new,job_title_id_new,is_new,is_change_effect_from_copy_data,nearest_working_record_id,invisible_change_salary,is_change_company_from_copy_data,context)"/>
       						 	/>
       						 		<!--<field name="change_form_id" required='0' on_change="onchange_change_form_id(change_form_id)"
       						 		context="{'active_test' : True}"/>-->
       						</group>
       						<group>
       							<field name="employee_code" readonly="1"/>
	       						<field name="contract_id" readonly='1' 
								options="{'no_quick_create' : True, 'no_create':True, 'no_open': True,'save_readonly': True}"/>
	       						<field name="contract_start_date" readonly='1' options="{'save_readonly': True}"/>
	       						<!--<field name="change_form_type_id" required='0' readonly="1" options="{'save_readonly': True}"/>-->
       						</group>
	       				</group>
	       				<group>
	       					<field name="change_form_ids" required='1' widget="many2many_tags" 
	       					context="{'active_test' : True,'rule_for_tree_form': True,'create':False,
	       						      'gross_salary_new':gross_salary_new, 'basic_salary_new':basic_salary_new,'salary_percentage_new':salary_percentage_new}"
	       					options="{'no_quick_create' : True, 'no_create':True, 'no_open': True,'save_readonly': True}"
	       					on_change="onchange_change_form_ids(change_form_ids, gross_salary_old, salary_percentage_old, basic_salary_old, kpi_amount_old, general_allowance_old,v_bonus_salary_old,fields_affect_by_change_form,fields_not_update, context)"/>
	       					<field name="fields_affect_by_change_form" invisible='1'/>
	       			    </group>
	       			    <group invisible='1'>
	       			    	<field name="decision_no" invisible='1'/>
       						<field name="signer_id" 
       						options="{'no_quick_create' : True, 'no_create':True, 'no_open': True,'save_readonly': True}"/>
       						<field name="sign_date"/>
       						<field name="signer_job_title_id"
       						options="{'no_quick_create' : True, 'no_create':True, 'no_open': True,'save_readonly': True}"/>
       						<field name="country_signer"
       						options="{'no_quick_create' : True, 'no_create':True, 'no_open': True,'save_readonly': True}"/>
	       			    </group>
   						<group col='4'>
       						<field name="keep_authority_fcnt" required='1' readonly='0'
			       					on_change="onchange_keep_authority_fcnt(keep_authority_fcnt)"/>
       						<field name="is_public"/>
   						</group>
   						<newline></newline>
       					<group colspan="1">
       						<!--<field name="attached_file" invisible='1'/>-->
       						<field name="note"/>
       						<field name="effect_to" invisible='1'/>
       						<field name="is_latest" invisible='1'/>
       						<field name="is_new" invisible='1'/>
       						<field name="is_change_from_contract" invisible='1'/>
       						<field name="is_change_team_from_contract" invisible='1'/>
       						<field name="is_change_employee_from_copy_data" invisible='1'/>
       						<field name="is_change_company_from_copy_data" invisible='1'/>
       						<field name="is_change_effect_from_copy_data" invisible='1'/>
       						<field name="is_change_title_from_copy_data" invisible='1'/>
       						<field name="is_person_do_action" invisible='1'/>
       						<field name="termination_id" invisible="1"/>
       						<field name="users_validated" invisible="1"/>
       						<field name="nearest_working_record_id" invisible="1"/>
       						<field name="invisible_change_salary" invisible="1"/>
       						<!--<field name="is_able_to_do_action_reject" invisible="1"/>-->
       						<field name='update_salary_in_create' invisible='1'/>
       						<field name='update_mask_data_in_create' invisible='1'/>
       						<field name='dept_complete_code_old' invisible='1'/>
       						<field name='dept_complete_code_new' invisible='1'/>
       						<field name='is_able_to_create_request' invisible='1'/>
       						<field name="is_change_form_adjust_salary" invisible='1'/>
       						<field name="fields_not_update" invisible='1' options="{'save_readonly': True}"/>
       						<field name="is_change_basic_salary_by_hand" invisible='1'/>
   							<field name="is_change_salary_percentage_by_hand" invisible='1'/>
   							<field name="is_change_gross_salary_by_hand" invisible='1'/>
   							<field name="is_special_change_form" invisible='1'/>
   							<field name="is_invisible_data_when_transfer_department" invisible='1'/>
   							<field name="is_change_job_level_person" invisible='1'/>
							<field name='contract_type' invisible='1'/>   							
       					</group>
       					<notebook>
	       					<page string="Detail">
	       						<group col="4">
	       							<group>
	       								<separator string="Old" colspan="2"/>
	       								<field name="work_for_company_id_old" readonly="1" invisible='1'
										options="{'no_quick_create' : True, 'no_create':True, 'no_open': True,'save_readonly': True}"/>
	       								<field name="office_id_old" readonly="1"
										options="{'no_quick_create' : True, 'no_create':True, 'no_open': True,'save_readonly': True}"/>
	       								<field name="division_id_old" readonly="1"
										options="{'no_quick_create' : True, 'no_create':True, 'no_open': True,'save_readonly': True}"/>
	       								<field name="department_group_id_old" readonly="1"
	       								options="{'no_quick_create' : True, 'no_create':True, 'no_open': True,'save_readonly': True}"/>
	       								<field name="department_id_old" readonly="1"
	       								options="{'no_quick_create' : True, 'no_create':True, 'no_open': True,'save_readonly': True}"/>
	       								<field name="team_id_old" readonly="1"
										options="{'no_quick_create' : True, 'no_create':True, 'no_open': True,'save_readonly': True}"/>
	       								<field name="job_title_id_old" readonly="1" 
	       								 attrs="{'invisible': [('is_invisible_data_when_transfer_department','=',True)]}"
										options="{'no_quick_create' : True, 'no_create':True, 'no_open': True,'save_readonly': True}"/>
	       							</group>
	       							<group>
		       							<separator string="New" colspan="2"/>
		       							<field name="work_for_company_id_new" required='1' invisible='1'
										options="{'no_quick_create' : True, 'no_create':True, 'no_open': True,'save_readonly': True}"/>
		       							<field name="office_id_new" required='1' colors="blue:office_id_new !=office_id_old"
										options="{'no_quick_create' : True, 'no_create':True, 'no_open': True,'save_readonly': True}"/>
		       							<field name="division_id_new" required='0' colors="blue:division_id_new !=division_id_old"
		       							 options="{'no_quick_create' : True, 'no_create':True, 'no_open': True,'save_readonly': True}"
		       							on_change="onchange_division_id_new(division_id_new, department_group_id_new, department_id_new, is_change_from_contract,context)"/>
		       							
		       						  <field name="department_group_id_new" colors="blue:department_group_id_new !=department_group_id_old"
		       							 options="{'no_quick_create' : True, 'no_create':True, 'no_open': True,'save_readonly': True}"
		       						    context="{'dept_from_division':division_id_new}"
		       							on_change="onchange_department_group_id_new(division_id_new,department_group_id_new,department_id_new,is_change_from_contract,context)"/>
		       							
		       						  <field name="department_id_new" required='1' on_change="onchange_department_id_new(department_id_new,team_id_new,is_change_from_contract, department_id_old, context)"
		       							  options="{'no_quick_create' : True, 'no_create':True, 'no_open': True,'save_readonly': True}"
		       							  colors="blue:department_id_new !=department_id_old" 
		       						  	  context="{'dept_from_department_group' : department_group_id_new,'dept_from_division_bypass_group':division_id_new}"/>	     
		       							  	  							
		       							<field name="team_id_new"  on_change="onchange_team_id_new(team_id_new,is_change_team_from_contract,context)"
		       							options="{'no_quick_create' : True, 'no_create':True, 'no_open': True,'save_readonly': True}"
		       							colors="blue:team_id_new !=team_id_old" context="{'dept_from_department' : department_id_new}"/>	       							
	       								<field name="job_title_id_new" required='1' 
	       								 colors="blue:job_title_id_new !=job_title_id_old"
	       								  attrs="{'invisible': [('is_invisible_data_when_transfer_department','=',True)]}"
	       								 options="{'no_quick_create' : True, 'no_create':True, 'no_open': True,'save_readonly': True}"/>
	       								<!-- on_change="onchange_job_title_id(job_title_id_new,job_level_id_new, pro_sub_group_id_new, is_change_title_from_copy_data)"-->
	       							</group>       								
	       						</group>
	       						<group col='4' attrs="{'invisible': [('is_invisible_data_when_transfer_department','=',True)]}">
	       							<group>
	       								<field name="career_track_id_old" readonly='1'
	       								options="{'no_quick_create' : True, 'no_create':True, 'no_open': True,'save_readonly': True}"/>
                                        	
                                		<field name="pro_job_family_id_old" readonly="1" string="Job Family"
										options="{'no_quick_create' : True, 'no_create':True, 'no_open': True,'save_readonly': True}"/>
                                    	<field name="pro_job_group_id_old" readonly="1"  string="Job Group"
                                    	options="{'no_quick_create' : True, 'no_create':True, 'no_open': True,'save_readonly': True}"/>
                                        
                                	 	<field name="pro_sub_group_id_old" readonly="1"  string="Sub Group"
                                    	options="{'no_quick_create' : True, 'no_create':True, 'no_open': True,'save_readonly': True}"/>
                                        	
		       						</group>
		       						<group>
		       							<field name="career_track_id_new" 
										attrs="{'required':[('contract_type','in',['OFFICIAl','PROBATION']),('effect_from','&gt;=','2016-04-01')],
		       							        'readonly': [('contract_type','not in',['OFFICIAl','PROBATION'])]}"
		       							colors="blue:career_track_id_new !=career_track_id_old"
		       							options="{'no_quick_create' : True, 'no_create':True, 'no_open': True,'save_readonly': True,'save_no_required':True}"/>
                                        		
	       								<field name="pro_job_family_id_new" required="1"  string="Job Family"
                                    		colors="blue:pro_job_family_id_new !=pro_job_family_id_old"
                                    		options="{'no_quick_create' : True, 'no_create':True, 'no_open': True,'save_readonly': True}"
                                    		on_change="onchange_pro_job_family_id_new(pro_job_family_id_new,pro_job_group_id_new,context)"/>
                                    	<field name="pro_job_group_id_new" required="1"  string="Job Group"
                                    	colors="blue:pro_job_group_id_new !=pro_job_group_id_old"
                                    	options="{'no_quick_create' : True, 'no_create':True, 'no_open': True,'save_readonly': True}"
                                    	on_change="onchange_pro_job_group_id_new(pro_job_group_id_new,pro_sub_group_id_new,context)"
                                    	context="{'filter_by_job_family_id' : pro_job_family_id_new}"/> 
                                            		
                                        <field name="pro_sub_group_id_new" readonly="1"  string="Sub group"
                                        context="{'filter_by_job_group_id':pro_job_group_id_new}"
                                    	colors="blue:pro_sub_group_id_new !=pro_sub_group_id_old"
                                    	options="{'no_quick_create' : True, 'no_create':True, 'no_open': True,'save_readonly': True}"/> 
                                            
		       						</group>
	       						</group>
	       						<group col='4' attrs="{'invisible': [('is_invisible_data_when_transfer_department','=',True)]}">
	       							<group style="width: 80%%">
		       							<field name="job_level_id_old" readonly="1"  string="Person Level"
		       							attrs="{'invisible':['|',('effect_from','&gt;=','2016-04-01'),('is_new','=',True)]}"
		       							options="{'no_quick_create' : True, 'no_create':True, 'no_open': True,'save_readonly': True}"/>
		       							
		       							<!--New job level -->
		       							<field name="job_level_person_id_old" readonly="1" 
		       							attrs="{'invisible': [('effect_from','&lt;','2016-04-01')]}"
		       							options="{'no_quick_create' : True, 'no_create':True, 'no_open': True,'save_readonly': True}"/>
		       							
	       							    <!--<field name="position_class_id_old" readonly="1" 
	       							    options="{'no_quick_create' : True, 'no_create':True, 'no_open': True,'save_readonly': True}"/>-->
	       							    <field name="manager_id_old" readonly="1" 
	       							    options="{'no_quick_create' : True, 'no_create':True, 'no_open': True,'save_readonly': True}"/>
	       								<field name="report_to_old" readonly="1" 
	       								options="{'no_quick_create' : True, 'no_create':True, 'no_open': True,'save_readonly': True}"/>
	       								<!--<field name="approver_id_old" readonly="1" options="{'save_readonly': True}"/>
		       							<field name="mentor_id_old" readonly="1" 
		       							options="{'no_quick_create' : True, 'no_create':True, 'no_open': True,'save_readonly': True}"/>-->
	       							</group>
	       							<group style="width: 100%%">
		       							<field name="job_level_id_new" string="Person Level"
										attrs="{'invisible':['|',('effect_from','&gt;=','2016-04-01'),('is_new','=',True)]}"
		       							readonly="1"  context="{'job_title_id' : job_title_id_new}"
		       							colors="blue:job_level_id_new !=job_level_id_old"
		       							options="{'no_quick_create' : True, 'no_create':True, 'no_open': True,'save_readonly': True}"/>
		       							
		       							<!--New job level -->
		       							<field name="job_level_person_id_new" 
		       							attrs="{'required':[('contract_type','in',['OFFICIAl','PROBATION']),('effect_from','&gt;=','2016-04-01')],
		       							        'readonly': [('contract_type','not in',['OFFICIAl','PROBATION'])],
		       									'invisible': [('effect_from','&lt;','2016-04-01')]}"
		       							colors="blue:job_level_person_id_new !=job_level_person_id_old"
		       							on_change="onchange_job_level_person_id_new(job_level_person_id_new, job_level_person_id_old, context)"
		       							options="{'no_quick_create' : True, 'no_create':True, 'no_open': True,'save_readonly': True}"/>
		       							<field name="job_level_person_comment" 
		       							groups="vhr_human_resource.vhr_cb_working_record"
		       							attrs="{'invisible':['|',('is_change_job_level_person','=',False),('contract_type','not in',['OFFICIAl','PROBATION'])]}"/>
		       								
		       							<!--<field name="position_class_id_new" required='0' 
		       							colors="blue:position_class_id_new !=position_class_id_old"
		       							options="{'no_quick_create' : True, 'no_create':True, 'no_open': True,'save_readonly': True}"/>-->
		       							<field name="manager_id_new" required='1' 
		       							colors="blue:manager_id_new !=manager_id_old"
		       							options="{'no_quick_create' : True, 'no_create':True, 'no_open': True,'save_readonly': True}"/>
	       								<field name="report_to_new" required='1' 
	       								colors="blue:report_to_new !=report_to_old"
	       								options="{'no_quick_create' : True, 'no_create':True, 'no_open': True,'save_readonly': True}"/>
		       							<!--<field name="approver_id_new" options="{'save_readonly': True}"/>
		       							<field name="mentor_id_new" 
		       							options="{'no_quick_create' : True, 'no_create':True, 'no_open': True,'save_readonly': True}"/>-->
		       							
	       							</group>
	       						</group>
	       						
	       						
		       					<group col="4" string="Others" attrs="{'invisible': [('is_invisible_data_when_transfer_department','=',True)]}">
		       						<group>
		       							<!-- Write in vhr_timesheet<field name="work_group_id_old" readonly="1" options="{'save_readonly': True}"/>-->
		       							<!-- Write in vhr_timesheet <field name="timesheet_id_old" readonly="1" options="{'save_readonly': True}"/>-->
		       							<field name="salary_setting_id_old" readonly="1" 
		       							options="{'no_quick_create' : True, 'no_create':True, 'no_open': True,'save_readonly': True}"/>
		       							<field name="seat_old" readonly="1" 
		       							options="{'no_quick_create' : True, 'no_create':True, 'no_open': True,'save_readonly': True}"/>
		       							<field name="ext_old" readonly="1" 
		       							options="{'no_quick_create' : True, 'no_create':True, 'no_open': True,'save_readonly': True}"/>  
		       							<!--<field name="work_email_old" readonly="1" 
		       							options="{'no_quick_create' : True, 'no_create':True, 'no_open': True,'save_readonly': True}"/>
		       							<field name="mobile_phone_old" readonly="1" 
		       							options="{'no_quick_create' : True, 'no_create':True, 'no_open': True,'save_readonly': True}"/>
		       							<field name="work_phone_old" readonly="1" 
		       							options="{'no_quick_create' : True, 'no_create':True, 'no_open': True,'save_readonly': True}"/>-->
		       						</group>
		       						<group>
		       							<!-- Write in vhr_timesheet<field name="work_group_id_new" context="{'dimension_type': 'WORK_GROUP'}" required='1' options="{'save_readonly': True}"/>-->
		       							<!--Write in vhr_timesheet <field name="timesheet_id_new" context="{'dimension_type': 'TIME_SHEET'}" required='1' options="{'save_readonly': True}"/>-->
		       							<field name="salary_setting_id_new" options="{'no_quick_create' : True, 'no_create':True, 'no_open': True,'save_readonly': True}"
		       							colors="blue:salary_setting_id_new !=salary_setting_id_old"
		       							attrs="{'required': ['|',('state','=','cb'),('state','=',False)]}"/>
		       							<field name="seat_new" options="{'save_readonly': True}"
		       							colors="blue:seat_new !=seat_old"/>
		       							<field name="ext_new" options="{'save_readonly': True,'validate_number': True}"
		       							colors="blue:ext_new !=ext_old"/>
		       							<!--<field name="work_email_new" options="{'save_readonly': True, 'validate_email': True}"/>
		       							<field name="mobile_phone_new" options="{'save_readonly': True,'validate_number': True}"/>
		       							<field name="work_phone_new" options="{'save_readonly': True,'validate_number': True}"/>-->
		       						</group>
		       					</group>
		       					<group string="Change Salary" name="change_salary" 
		       						attrs="{'invisible': [('invisible_change_salary','=',True)]}">
		       						<group>
		       							<field name="gross_salary_old" readonly="1" options="{'save_readonly': True}"/>
										<field name="salary_percentage_old" readonly="1" options="{'save_readonly':True}"/>		       							
		       							<field name="basic_salary_old" readonly="1" options="{'save_readonly': True}"/>
		       							<field name="kpi_amount_old" readonly="1" options="{'save_readonly': True}"/>
		       							<field name="v_bonus_salary_old" readonly="1" options="{'save_readonly': True}"/>
		       							<field name="general_allowance_old" readonly="1" options="{'save_readonly': True}"
		       							attrs="{'invisible': [('effect_from','&gt;=','2016-04-01')]}"/>
		       						</group>
		       						<group>
		       							<field name="gross_salary_new" options="{'save_readonly': True}" context="{'rewrite_field': True}"
		       								colors="blue:gross_salary_new !=gross_salary_old"
		       								on_change="onchange_gross_salary(gross_salary_new,basic_salary_new,kpi_amount_new,salary_percentage_new,is_change_gross_salary_by_hand,context)"/>
		       							<field name="salary_percentage_new" options="{'save_readonly':True}" 
		       								colors="blue:salary_percentage_new !=salary_percentage_old"
											on_change="onchange_salary_percentage(gross_salary_new, basic_salary_new, kpi_amount_new,salary_percentage_new,is_change_salary_percentage_by_hand,context)"/>
		       					
		       							<field name="basic_salary_new" options="{'save_readonly': True}"  
		       								colors="blue:basic_salary_new !=basic_salary_old"
		       								on_change="onchange_basic_salary(gross_salary_new, basic_salary_new, kpi_amount_new,salary_percentage_new,is_change_basic_salary_by_hand,context)"/>
		       							<field name="kpi_amount_new" options="{'save_readonly': True}"
		       								colors="blue:kpi_amount_new !=kpi_amount_old"
		       								 on_change="onchange_kpi_amount(gross_salary_new, basic_salary_new, kpi_amount_new,context)"/>
		       							<field name="v_bonus_salary_new" options="{'save_readonly': True}"
		       								colors="blue:v_bonus_salary_new !=v_bonus_salary_old"
		       								 on_change="onchange_v_bonus_salary(gross_salary_new, basic_salary_new, kpi_amount_new, v_bonus_salary_new,context)"/>
		       							
		       						    <field name="general_allowance_new" options="{'save_readonly': True}"
		       								colors="blue:general_allowance_new !=general_allowance_old"
		       						    	attrs="{'invisible': [('effect_from','&gt;=','2016-04-01')]}"/>
		       							<!--on_change="onchange_general_allowance(gross_salary_new, basic_salary_new, kpi_amount_new, general_allowance_new,context)"-->
		       						</group>
		       					</group>
		       					<group col="4">
			       					<field name="keep_authority" groups="vhr_base.hrs_group_system" options="{'save_readonly': True}"/>
			       					<field name="active" readonly="1"/>
			       				</group>
			       			</page>
			       			<page string="Logs"  groups="vhr_base.hrs_group_system,vhr_human_resource.vhr_cb_working_record">
			       				<label string="*** Please press F5 to refresh the list of logs !" colspan="4"/>
		                        <field name="audit_log_ids" mode="tree"
		                               widget="one2many_list" readonly="1" nolabel="1" colspan="4">
		                            <tree version="7.0">
		                                <field name="timestamp" required="1" readonly="1"/>
		                                <field name="user_id" readonly="1"/>
		                                <field name="method" readonly="1"/>
		                                <field name="field_description"/>
		                                <field name="old_value_text"/>
		                                <field name="new_value_text"/>
		                            </tree>
		                        </field>
	                        </page>
	                        <page string="Log state changes" attrs="{'invisible': [('state','=',False)]}">
                                    <field name="state_log_ids" readonly="1"/>
                            </page>
			       		</notebook>
			       </sheet>		
       			</form>
       		</field>
       	</record>
       	
       	<record id="view_vhr_working_record_tree" model="ir.ui.view">
       		<field name="name">vhr.working.record.view.tree</field>
       		<field name="model">vhr.working.record</field>
       		<field name="arch" type="xml">
      			<tree string="Working Record" version="7.0"
      				colors="blue:is_public==False">
      				<field name="employee_code"/>
      				<field name="employee_id"/>
      				<field name="contract_id"/>
      				<field name="company_code" string="Entity"/>
      				<field name="department_id_new"/>
      				<field name="job_title_id_new"/>
      				<field name="change_form_name"/>
					<field name="effect_from" string="Effective From"/>
					<field name="effect_to" string="Effective To"/>
					<field name="salary_setting_id_new"/>
					<!--Write in vhr_timesheet <field name="timesheet_id_new"/>-->
					<field name="create_user"/>
					<field name="create_date"/>	
					<field name="write_user"/>
					<field name="write_date"/>
					<field name="is_public" invisible="1"/>
      			</tree>
     		</field>
       	</record>
       	
       	<record id="view_vhr_working_record_waiting_for_public_tree" model="ir.ui.view">
       		<field name="name">vhr.working.record.view.waiting.for.public.tree</field>
       		<field name="model">vhr.working.record</field>
       		<field name="arch" type="xml">
      			<tree string="Working Record" version="7.0"
      				colors="blue:is_public==False">
      				<field name="employee_code"/>
      				<field name="employee_id"/>
      				<field name="contract_id"/>
      				<field name="company_code" string="Entity"/>
      				<field name="department_id_new"/>
      				<field name="job_title_id_new"/>
      				<field name="change_form_name"/>
					<field name="effect_from" string="Effective Date"/>
					<field name="salary_setting_id_new"/>
					<!--Write in vhr_timesheet <field name="timesheet_id_new"/>-->
					<field name="create_user"/>
					<field name="create_date"/>	
					<field name="write_user"/>
					<field name="write_date"/>
					<field name="is_public" invisible="1"/>
      			</tree>
     		</field>
       	</record>
       	
       	<record id="view_vhr_working_record_staff_movement_tree" model="ir.ui.view">
       		<field name="name">vhr.working.record.staff.movement.view.tree</field>
       		<field name="model">vhr.working.record</field>
       		<field name="arch" type="xml">
      			<tree string="Working Record" version="7.0" 
      			   colors="blue:state not in ('finish','cancel')">
      				<field name="employee_code"/>
      				<field name="employee_id"/>
      				<field name="contract_id"/>
      				<field name="company_id"/>
      				<field name="department_id_new"/>
      				<field name="job_title_id_new"/>
      				<field name="change_form_name"/>
					<field name="effect_from" string="Effective Date"/>
					<field name="salary_setting_id_new"/>
					<!--Write in vhr_timesheet <field name="timesheet_id_new"/>-->
					<field name="state" string="Status"/>
					<field name="waiting_for"/>
					<field name="create_user"/>
					<field name="create_date"/>	
					<field name="write_user"/>
					<field name="write_date"/>
					<field name="is_waiting_for_action" invisible='1'/>
      			</tree>
     		</field>
       	</record>
       	
       	<record id="view_vhr_working_record_search" model="ir.ui.view">
        	<field name="name">vhr.working.record.view.search</field>
        	<field name="model">vhr.working.record</field>
        	<field name="arch" type="xml">
        		<search string="Working Record">
        			<group expand="0" string="Group by...">
        				<filter string="Company" name="company" context="{'group_by':'company_id'}"/>
        			</group>        			
        			<group expand="0" string="Filter by Employee">
                    	<filter string="Active Employee" name="active_employee" icon="terp-stage"
                                    domain="[('employee_id.active', '=', True)]"/>
                        <filter string="Inactive Employee" name="inactive_employee" icon="terp-stage"
                                domain="[('employee_id.active', '=', False)]"/>
                    </group>
                    <group expand="0" string="Filter">
        				<filter string="Active = True" name="active_true" icon="terp-stage"
                            domain="[('active', '=', True)]"/>
	                    <filter string="Active = False" name="active_false" icon="STOCK_NEW"
	                            domain="[('active', '=', False)]"/>
	                    
	                    <filter string="Publish = True" name="publish_true" icon="terp-stage"
                            domain="[('is_public', '=', True)]"/>
	                    <filter string="Publish = False" name="publish_false" icon="STOCK_NEW"
	                            domain="[('is_public', '=', False)]"/>        	
	                    
        			</group>
                    <field name="name" string="Working Record" 
	                  		filter_domain="['|','|','|','|',('name','ilike',self),('employee_id.name','ilike',self),('employee_id.login','ilike',self),('employee_id.code','ilike',self),('contract_id.name','ilike',self)]"/>

        			<field name="division_id_new"/>
					<field name="department_id_new"/>
                     
        		</search>
        	</field>
        </record>
        
        <record id="view_vhr_working_record_movement_search" model="ir.ui.view">
        	<field name="name">vhr.working.record.movement.view.search</field>
        	<field name="model">vhr.working.record</field>
        	<field name="arch" type="xml">
        		<search string="Working Record">
        			<group expand="0" string="Group by...">
        				<filter string="Company" name="company" context="{'group_by':'company_id'}"/>
        			</group>        			
                    <group expand="0" string="Filter by Employee">
                    	<filter string="Active Employee" name="active_employee" icon="terp-stage"
                                    domain="[('employee_id.active', '=', True)]"/>
                        <filter string="Inactive Employee" name="inactive_employee" icon="terp-stage"
                                domain="[('employee_id.active', '=', False)]"/>
                    </group>
                    <group expand="0" string="Filter">
        				<filter string="Active = True" name="active_true" icon="terp-stage"
                            domain="[('active', '=', True)]"/>
                    	<filter string="Active = False" name="active_false" icon="STOCK_NEW"
                            domain="[('active', '=', False)]"/>
                    </group>
                    <group expand="0" string="Filter Waiting For">
        				<filter string="Waiting For Approval" name="waiting_for_action" icon="terp-stage"
                            domain="[('is_waiting_for_action', '=', True)]"/>
                    </group>
                    <group expand="0" string="Status">
                    	<filter string="Draft" name="state_draft" icon="STOCK_NEW"
                            domain="[('state', '=', 'draft')]"/>
                    	
                    	<filter string="Waiting New HRBP" name="state_new_hrbp" icon="STOCK_NEW"
                            domain="[('state', '=', 'new_hrbp')]"/>
                    	<filter string="Waiting HRD" name="state_dept_hr" icon="STOCK_NEW"
                            domain="[('state', '=', 'dept_hr')]"/>
                    	<filter string="Waiting C&amp;B" name="state_cb" icon="STOCK_NEW"
                            domain="[('state', '=', 'cb')]"/>
                    	<filter string="Waiting C&amp;B 2" name="state_cb" icon="STOCK_NEW"
                            domain="[('state', '=', 'cb2')]"/>
                    	<filter string="Finish" name="state_finish" icon="STOCK_NEW"
                            domain="[('state', '=', 'finish')]"/>
                    	<filter string="Cancel" name="state_cancel" icon="STOCK_NEW"
                            domain="[('state', '=', 'cancel')]"/>
        			</group>
                    <field name="name" string="Working Record" 
	                  		filter_domain="['|','|','|','|',('name','ilike',self),('employee_id.name','ilike',self),('employee_id.login','ilike',self),('employee_id.code','ilike',self),('contract_id.name','ilike',self)]"/>

        			<field name="division_id_new"/>
					<field name="department_id_new"/>
                     
        		</search>
        	</field>
        </record>
        
        <record id="act_hr_contract_2_working_record" model="ir.actions.act_window">
            <field name="res_model">vhr.working.record</field>
            <field name="view_type">form</field>
            <field name="name">Working Record</field>
            <field name="view_mode">tree,form</field>
            <field name="view_id" ref="view_vhr_working_record_waiting_for_public_tree"/>
            <field name="search_view_id" ref="view_vhr_working_record_search"/>
            <field name="domain">[('contract_id','=',active_id)]</field>
            <field name="context">{'search_default_contract_id': [active_id], 'rule_for_tree_form': True, 'publish': False,
            					   'create': False,'approve':False,'return':False,'reject':False,'default_is_new': False,'get_department_name_by_code':True,
            					   'default_is_latest': True, 'record_type': 'record','get_working_record_in_flow': True,'get_office_name_by_code':True}</field>
        </record>

       	<act_window name="Duplicate" res_model="vhr.working.record"
            src_model="vhr.working.record" view_mode="form"
            view_id="view_vhr_working_record_form"
            key2="client_action_multi" context="{'record_type': context.get('record_type'),'duplicate_active_id': active_id}"
            id="action_duplicate_vhr_working_record" />
       	
       <record id="action_public_vhr_working_record_action" model="ir.actions.server">
            <field name="name">Publish</field>
            <field name="model_id" ref="model_vhr_working_record"/>
            <field name="state">code</field>
            <field name="code">action = self.open_confirm_form(cr, uid, context.get('active_ids', []), context=context)</field>
        </record>
        
        <record model="ir.values" id="action_public_vhr_working_record">
            <field name="key2">client_action_multi</field>
            <field name="model">vhr.working.record</field>
            <field name="name">Publish</field>
            <field name="value" eval="'ir.actions.server,%d'%action_public_vhr_working_record_action"/>
            <field name="object" eval="True"/>
        </record>
       	
       	<record model="ir.actions.act_window" id="act_vhr_working_record_hr">
       		<field name="name">Records</field> 
            <field name="res_model">vhr.working.record</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="limit">40</field>
            <field name="context">{'record_type': 'record','search_default_active_employee': 1,'search_default_active_true':1,'get_department_name_by_code':True,
            	'rule_for_tree_form': True,'approve':False,'return':False,'reject':False,'export':False,'get_office_name_by_code':True}</field> 
            <field name="view_id" ref="view_vhr_working_record_tree"/>
            <field name="search_view_id" ref="view_vhr_working_record_search"/>
       	</record>
       	
       	<record model="ir.actions.act_window" id="act_vhr_working_record_staff_movement">
       		<field name="name">Requests</field> 
            <field name="res_model">vhr.working.record</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[('state','!=','reject')]</field>
            <field name="context">{'record_type': 'request','default_state':'draft','rule_for_tree_form': True,'publish':False,
            						'search_default_active_employee': 1,'get_office_name_by_code':True,'get_department_name_by_code':True,
					            	'search_default_waiting_for_action':1,'export':False}</field>
            <field name="view_id" ref="view_vhr_working_record_staff_movement_tree"/>
            <field name="search_view_id" ref="view_vhr_working_record_movement_search"/>
       	</record>
       	
       	<record model="ir.actions.act_window" id="act_vhr_working_record_waiting_for_public">
       		<field name="name">Waiting for Publish</field> 
            <field name="res_model">vhr.working.record</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="context">{'record_type': 'record','public_WR': 0, 'search_default_active_employee': 1,'rule_for_tree_form': True,'get_department_name_by_code':True,
            					   'approve':False,'return':False,'reject':False,'create':False,'duplicate':False,'get_office_name_by_code':True}</field>
            <field name="view_id" ref="view_vhr_working_record_waiting_for_public_tree"/>
            <field name="search_view_id" ref="view_vhr_working_record_search"/>
       	</record>
       	
       	
       	<record id="action_vhr_working_record_print_privacy_statement" model="ir.actions.server">
            <field name="name">Print Privacy Statement + Appendix</field>
            <field name="model_id" ref="model_vhr_working_record"/>
            <field name="state">code</field>
            <field name="code">action = self.action_print_multi_privacy_statement(cr, uid, context.get('active_ids', []))</field>
        </record>
        
        <record model="ir.values" id="action_vhr_working_record_print_privacy_statement_act">
            <field name="key2">client_print_multi</field>
            <field name="model">vhr.working.record</field>
            <field name="name">Print Privacy Statement + Appendix</field>
            <field name="value" eval="'ir.actions.server,%d'%action_vhr_working_record_print_privacy_statement"/>
            <field name="object" eval="True"/>
        </record>
       	
    </data>
</openerp>