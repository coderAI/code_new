<?xml version="1.0" encoding="UTF-8"?>
<openerp>
    <data>
    	
    	<record id="view_vhr_working_record_mass_movement_submit_form" model="ir.ui.view">
        	<field name="name">vhr.working.record.mass.movement.submit.form</field>
            <field name="model">vhr.working.record.mass.movement</field>
            <field name="type">form</field>
            <field name="priority" eval="20"/>
            <field name="arch" type="xml">
                <form string="Note" version="7.0">
                	<group string="You have to attach file before submit !"   class="vhr_human_resource_warning_message" invisible="not context.get('is_require_data_for_submit')">
                		<field name="attachment_ids" required="context.get('is_require_data_for_submit')" nolabel='1' 
                			context="{'default_res_id':context.get('active_id'),'default_res_model':context.get('active_model'),
                			          'do_not_validate_read_attachment':'True'}">
                			<tree string="Attachment" version="7.0" editable="bottom">
                				<field name="datas" filename="datas_fname" trigger_on_change='True' string="File"/>
			                    <field name="datas_fname" options='{"file_download": 1, "field_data": "datas"}' invisible="1"/>
			                    <field name="create_date" invisible="1"/>
			                    <field name="write_uid" string="Updated by" invisible="1"/>
			                    <field name="res_id" invisible='1' options="{'save_readonly': True}"/>
			                    <field name="res_model" invisible='1' options="{'save_readonly': True}"/>
			                </tree>
                		</field>
                		<field name="is_required_attachment" invisible='1'/>
                	</group>
                	
                    <separator string="Comment" colspan="4" required="context.get('required_comment',False)"/>
                    <footer>
                		<div attrs="{'invisible': [('attachment_ids','=',[]),('is_required_attachment','=',True)]}">
                    		<button name="execute_workflow"
                                string="Submit"  one_click_button="True"
                                type="object" icon="gtk-save"
                                class="oe_highlight" context="{'ACTION_COMMENT': action_comment}"/>
	                        or
	                        <button string="Cancel" class="oe_link" special="cancel"/>
                    	</div>
                    	
                    </footer>
                </form>
            </field>
        </record>
    	
		<record id="view_vhr_working_record_mass_movement" model="ir.ui.view">
	        <field name="name">vhr.working.record.mass.movement</field>
            <field name="model">vhr.working.record.mass.movement</field>
            <field name="type">form</field>
            <field name="arch" type="xml">
                <form string="Mass Movement" version="7.0">
                    <sheet>
                    	<div class="oe_right" name="buttons">
	                        <div class="oe_right" name="buttons">
	                        	<button name="open_window"
	                                string="Execute"
	                                type="object"
		                        	icon="fa-book"
	                        		context="{'action':'submit'}"
		                        	invisible="context.get('search_default_active_true',False)"
	                                class="oe_stat_button"/>
	                        	
                                <button name="open_window"
	                                string="Execute"
	                                type="object"
		                        	icon="fa-book"
	                                confirm="Are you sure you want to execute ?"
	                        		invisible="context.get('default_state',False)"
	                        		context="{'action':'submit'}"
	                                class="oe_stat_button"/>
	                        </div>
                        </div>
                    	<group col="4">
                    		<field name="company_id" required='1'  
                    		options="{'no_quick_create' : True, 'no_create':True, 'no_open': True,'save_readonly': True}"
                    			string="Entity"
	       						 on_change="onchange_company_id(company_id,effect_from,context)"/>
                    		<field name="effect_from" required='1' string="Effective Date"
                    		  options="{'save_readonly': True}" 
                    		  attrs="{'readonly': [('employee_ids','!=',	[[6,False,[]]])]}"
                    		  on_change="onchange_effect_from(company_id,effect_from)"/>
       						<!--<newline/>
       						<field name="change_form_id" required='1'
       						  on_change="onchange_change_form_id(change_form_id)"/>
       						<field name="change_form_type_id" readonly="0" options="{'save_readonly': True}"/>-->
       						
       						<field name="change_form_ids" required='1' widget="many2many_tags" colspan='4' context="{'active_test' : True}"
       						options="{'no_quick_create' : True, 'no_create':True, 'no_open': True,'save_readonly': True}"
       						on_change="onchange_change_form_ids(change_form_ids,fields_affect_by_change_form,division_id_old, department_group_id_old, department_id_old )"/>
	       					<newline/>
	       					<field name="fields_affect_by_change_form" invisible='1'/>
       						<field name="decision_no"/>
       						<field name="signer_id"/>
       						<field name="sign_date"/>
       						<field name="signer_job_title_id"/>
       						<field name="is_public"/>
       						<field name="name" invisible="1"/>
       						<field name="is_able_to_create" invisible="1"/>
       						<field name="is_change_form_adjust_salary" invisible='1'/>
       						<field name="is_change_basic_salary_by_hand" invisible='1'/>
   							<field name="is_change_salary_percentage_by_hand" invisible='1'/>
       						<newline/>
                    	</group>
                    	<group col="4" string="Old" attrs="{'invisible': [('is_change_team','=',False)]}"	>
   							<field name="division_id_old" attrs="{'required': [('is_change_team','=',True)]}" on_change="onchange_division_id_old(division_id_old)"
   							options="{'no_quick_create' : True, 'no_create':True, 'no_open': True,'save_readonly': True}"/>
   							
   							<field name="department_group_id_old"
   							context="{'dept_from_division' : division_id_old}"	
   							on_change="onchange_department_group_id_old(department_group_id_old)"
   							options="{'no_quick_create' : True, 'no_create':True, 'no_open': True,'save_readonly': True}"/>
   							
   							<field name="department_id_old" attrs="{'required': [('is_change_team','=',True)]}"
   							on_change="onchange_department_id_old(department_id_old,division_id_old,division_id_new,context)" 
   							options="{'no_quick_create' : True, 'no_create':True, 'no_open': True,'save_readonly': True}"
   							context="{'dept_from_department_group' : department_group_id_old,'dept_from_division_bypass_group':division_id_old}"/>
   							<field name="is_change_team" invisible='1'/>
						</group>
                    	<group col="4" string="New">
                    		<field name="work_for_company_id_new" invisible='1'
                    		options="{'no_quick_create' : True, 'no_create':True, 'no_open': True,'save_readonly': True}"/>
                    		<newline/>
                			<field name="office_id_new" on_change="onchange_office_id_new()"
                			options="{'no_quick_create' : True, 'no_create':True, 'no_open': True,'save_readonly': True}"/>
                			
                			<field name="division_id_new" on_change="onchange_division_id_new()"
                			options="{'no_quick_create' : True, 'no_create':True, 'no_open': True,'save_readonly': True}"/>
                			
							<field name="department_group_id_new" on_change="onchange_department_group_id_new()"
							context="{'dept_from_division' : division_id_new}"	
                			options="{'no_quick_create' : True, 'no_create':True, 'no_open': True,'save_readonly': True}"/>
							
                   			<field name="department_id_new" on_change="onchange_department_id_new(department_id_new)" 
                			options="{'no_quick_create' : True, 'no_create':True, 'no_open': True,'save_readonly': True}"
                			attrs="{'required': [('division_id_new','!=',False)]}"	
							context="{'dept_from_department_group' : department_group_id_new,'dept_from_division_bypass_group':division_id_new}"/>
                			<field name="team_id_new" on_change="onchange_team_id_new(team_id_new)" 
                			options="{'no_quick_create' : True, 'no_create':True, 'no_open': True,'save_readonly': True}"
							context="{'dept_from_department' : department_id_new}"/>
                			
                			<field name="job_title_id_new"
                			options="{'no_quick_create' : True, 'no_create':True, 'no_open': True,'save_readonly': True}"
                				on_change="onchange_job_title_id_new(job_title_id_new,False,pro_sub_group_id_new)"/>
                			<!--<field name="job_level_id_new" invisible='1'
                			options="{'no_quick_create' : True, 'no_create':True, 'no_open': True,'save_readonly': True}"
                			   context="{'job_title_id' : job_title_id_new}"/>-->
                			
                			<!--New job level -->
   							<field name="job_level_person_id_new"
   							options="{'no_quick_create' : True, 'no_create':True, 'no_open': True,'save_readonly': True}"/>
   							
                			<!--<field name="position_class_id_new"
                			options="{'no_quick_create' : True, 'no_create':True, 'no_open': True,'save_readonly': True}"/>-->
                    			
						</group>	
						<group col='4'  invisible="not context.get('show_other_info',False)">
                    		<field name="pro_job_family_id_new" 
                    		options="{'no_quick_create' : True, 'no_create':True, 'no_open': True,'save_readonly': True}"
                    	 	on_change="onchange_pro_job_family_id_new(pro_job_family_id_new,pro_job_group_id_new,context)"/>
                        	<field name="pro_job_group_id_new" 
                        	options="{'no_quick_create' : True, 'no_create':True, 'no_open': True,'save_readonly': True}"
                        	 context="{'filter_by_job_family_id' : pro_job_family_id_new}"/>
                        	<!-- on_change="onchange_pro_job_group_id_new(pro_job_group_id_new,pro_sub_group_id_new,context)" -->	
                        	<field name="pro_sub_group_id_new" 
                        	options="{'no_quick_create' : True, 'no_create':True, 'no_open': True,'save_readonly': True}"/>
                        	<!-- context="{'filter_by_job_group_id' : pro_job_group_id_new}"-->
   						</group>
			       		<newline/>
						<group col='4'>
							<field name="report_to_new"
							options="{'no_quick_create' : True, 'no_create':True, 'no_open': True,'save_readonly': True}"/>
                			<!--<field name="approver_id_new"/>
                			<field name="mentor_id_new"
                			options="{'no_quick_create' : True, 'no_create':True, 'no_open': True,'save_readonly': True}"/>-->
                			<field name="manager_id_new" readonly='1' 
                			options="{'no_quick_create' : True, 'no_create':True, 'no_open': True,'save_readonly': True}"/>
						</group>
						<newline/>
						
						<group col="4">
                    		<!--Write in vhr_timesheet<field name="work_group_id_new"/>
                    		 <field name="timesheet_id_new"/>-->
                    		<field name="salary_setting_id_new" 
                    		options="{'no_quick_create' : True, 'no_create':True, 'no_open': True,'save_readonly': True}"/>
                    	</group>
                    	<group col="4">
                    		<field name="seat_new"/>
                    		<field name="ext_new"  options="{'save_readonly': True,'validate_number': True}"/>
                    		<!--<field name="mobile_phone_new" options="{'save_readonly': True,'validate_number': True}"/>
                    		<field name="work_phone_new" options="{'save_readonly': True,'validate_number': True}"/>
                    		<field name="work_email_new" options="{'save_readonly': True, 'validate_email': True}"/>-->
                    	</group>
                    	<group col='4' name='change_salary'>
   							<field name="gross_salary_new" options="{'save_readonly': True}" 
   								attrs="{'required': [('salary_percentage_new','!=',False)]}"	
   								on_change="onchange_gross_salary(gross_salary_new, basic_salary_new, kpi_amount_new,salary_percentage_new,is_change_salary_percentage_by_hand,context)"/>
   							<field name="salary_percentage_new" options="{'save_readonly':True}"
								on_change="onchange_salary_percentage(gross_salary_new, basic_salary_new, kpi_amount_new,salary_percentage_new,is_change_salary_percentage_by_hand,context)"/>
   							<field name="basic_salary_new" options="{'save_readonly': True}"  
   								on_change="onchange_basic_salary(gross_salary_new, basic_salary_new, kpi_amount_new, salary_percentage_new,is_change_basic_salary_by_hand,context)"/>
   							<field name="kpi_amount_new" options="{'save_readonly': True}"
   								 on_change="onchange_kpi_amount(gross_salary_new, basic_salary_new, kpi_amount_new, context)"/>
   							<field name="v_bonus_salary_new" options="{'save_readonly': True}"
   								 on_change="onchange_v_bonus_salary(gross_salary_new, basic_salary_new, kpi_amount_new, v_bonus_salary_new,context)"/>
   			
   							<field name="general_allowance_new" options="{'save_readonly': True}"/>
   							<!--on_change="onchange_general_allowance(gross_salary_new, basic_salary_new, kpi_amount_new, general_allowance_new,context)"-->
   							<!--<field name="collaboration_salary_new" options="{'save_readonly': True}"/>-->
   						</group>
                    	<group colspan="4">
                    		<field name="note"/>
                    	</group>
                    	<group string="Employees">
                    		<p class="vhr_human_resource_important_message">
	                            <i class="fa fa-exclamation-triangle"></i>
	                            You have to choose all required fields before choosing list of employees !
	                        </p>
	                        <newline/>
                    		<field name="employee_ids" nolabel="1" required="1"
                    		context="{'department_id_can_false':True,'department_id':department_id_old,'force_search_hr_employee':False,
                    				  'search_view_ref':'vhr_human_resource.view_vhr_human_resource_mimimal_employee_search_job_level',
                    				  'tree_view_ref':'vhr_human_resource.view_vhr_human_resource_mimimal_employee_tree',
                    				   'company_id':company_id,'effect_date':effect_from,'filter_by_working_record':True}"
                    		options="{'no_quick_create' : True, 'no_create':True, 'no_open': True,'save_readonly': True}"/>
                    	</group>
                    </sheet>
                </form>
            </field>
        </record>
        
        <!--Support for filter and search by job level-->
        <record id="view_vhr_human_resource_mimimal_employee_search_job_level" model="ir.ui.view">
            <field name="name">hr.employee.view.search.job.level</field>
            <field name="model">hr.employee</field>
            <field name="priority" eval="28"/>
            <field name="groups_id" eval="[(4, ref('base.group_user'))]"/>
            <field name="arch" type="xml">
                <search string="Employees">
                    <group expand="0" string="Group By">
                        <filter string="Company" icon="terp-go-home" domain="[]"
                                context="{'group_by':'company_id'}"/>                            
                        <filter string="Division" icon="terp-personal+" domain="[]"
                                context="{'group_by':'division_id'}"/>        	
                        <filter string="Department" icon="terp-personal+" domain="[]"
                                context="{'group_by':'department_id'}"/>
                        <filter string="Team" icon="terp-personal+" domain="[]" 
                        		context="{'group_by':'team_id'}"/>
                        <filter string="Job Title" icon="terp-gtk-select-all" domain="[]"
                                context="{'group_by':'title_id'}"/>
                        <!--<filter string="Job Level" icon="terp-gtk-select-all" domain="[]"
                                context="{'group_by':'job_level_id'}"/>-->
                    </group>
                    <group expand="0" string="Filter">
                        <filter string="Active = True" name="active_true" icon="terp-stage"
                                domain="[('active', '=', True)]"/>
                        <filter string="Active = False" name="active_false" icon="STOCK_NEW"
                                domain="[('active', '=', False)]"/>
                        <filter string="Reject = True" name="active_false" icon="STOCK_NEW"
                                domain="['&amp;',('is_reject', '=', True),'|',('active', '=', True),('active', '=', False)]"/>
                    </group>
                    <field name="name" string="Employees"
                           filter_domain="['|','|',('name','ilike',self),('login','ilike',self),('code','ilike',self)]"/>
                    <field name="department_id"/>
                    <field name="team_id"/>
                    <!--<field name="job_level_id"/>-->
                    <field name="join_date" string="Join Date &#62;=" filter_domain="[('join_date','>=',self)]"/>
                </search>
            </field>
        </record>
        
        
        <record id="act_vhr_working_record_mass_hr" model="ir.actions.act_window">
            <field name="name">Mass Records</field>
            <field name="res_model">vhr.working.record.mass.movement</field>
            <field name="type">ir.actions.act_window</field>
            <field name="view_type">form</field>
            <field name="view_mode">form</field>
            <field name="view_id" ref="view_vhr_working_record_mass_movement"/>
            <field name="context">{'record_type': 'record','search_default_active_true':1, 'show_other_info':True, 'hide_form_view_button':True}</field> 
            <field name="target">current</field>
       </record>
       
       <record model="ir.actions.act_window" id="act_vhr_working_record_mass_hr_status">
       		<field name="name">Mass Record Progress</field> 
            <field name="res_model">vhr.mass.status</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[('type','=','record'),('model_id.model','=','vhr.working.record')]</field>
            <field name="view_id" ref="vhr_common.view_vhr_mass_status_tree"/>
            <field name="search_view_id" ref="vhr_common.view_vhr_mass_status_search"/>
       	</record>
       	
       
        <record id="act_vhr_working_record_mass_movement" model="ir.actions.act_window">
            <field name="name">Multi Requests</field>
            <field name="res_model">vhr.working.record.mass.movement</field>
            <field name="type">ir.actions.act_window</field>
            <field name="view_type">form</field>
            <field name="view_mode">form</field>
            <field name="view_id" ref="view_vhr_working_record_mass_movement"/>
            <field name="context">{'record_type': 'request','default_state':'draft', 'show_other_info':True, 'hide_form_view_button':True}</field>
            <field name="target">current</field>
       </record>
       
       <record model="ir.actions.act_window" id="act_vhr_working_record_mass_movement_status">
       		<field name="name">Multi Requests Progress</field> 
            <field name="res_model">vhr.mass.status</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[('type','=','request'),('model_id.model','=','vhr.working.record')]</field>
            <field name="view_id" ref="vhr_common.view_vhr_mass_status_tree"/>
            <field name="search_view_id" ref="vhr_common.view_vhr_mass_status_search"/>
       	</record>
       
       
       
       
       
       
        
    </data>
</openerp>