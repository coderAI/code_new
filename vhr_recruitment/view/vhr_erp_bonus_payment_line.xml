<?xml version="1.0" encoding="utf-8"?>
<openerp>
    <data>
        <record id="view_vhr_erp_bonus_payment_line_form" model="ir.ui.view">
            <field name="name">vhr.erp.bonus.payment.line.form</field>
            <field name="model">vhr.erp.bonus.payment.line</field>
            <field name="arch" type="xml">
                <form string="ERP Bonus Payment Line" version="7.0" create="0" delete="0" duplicate='false'>
	                <header>
		                <field name="state" widget="statusbar" nolabel="1"/>
		            </header>
       				<sheet>
       					<div class="oe_right" name="buttons">
       						<button class="oe_stat_button bg_icon_green" string="Payment" name="action_payment"  
       							confirm="Are you sure you want to execute ?"
                           		states="draft" icon="fa-mail-forward" type="object"/>
                           	<button class="oe_stat_button bg_icon_red" string="Cancel" name="action_cancel"
                           		confirm="Are you sure you want to execute ?"  
                           		states="draft" icon="fa-times" type="object"/>
       					</div>
       					<group> 
       						<field name="bonus_payment_id" class="hrs_color_warning_lb_big" string="Payment bonus" 
       							readonly="1" />
       					</group>
       					<group string="Payment Info" col="4">
      						<field name="applicant_id" readonly="1"/> 
      						<field name="payment_date" readonly="1"/>
      						<field name="payment_time_id" readonly="1"/>
      						<field name="payment_rate" readonly="1"/>
     						<field name="payment_value" readonly="1"/>       						
       						<field name="exclusion_id" readonly="1"/>
       					</group>
       					<group>
	       					<field name="note"/>
						</group>
       					<notebook>
	       					<page string="Logs">
		                        	<label string="*** Please press F5 to refresh the list of logs !" colspan="4"/>
			                        <field name="audit_log_ids" mode="tree"
			                               widget="one2many_list" readonly="1" nolabel="1" colspan="4">
			                            <tree version="7.0">
			                                <field name="timestamp" required="1" readonly="1"/>
			                                <field name="user_id" readonly="1"/>
			                                <field name="method" readonly="1"/>
			                                <field name="field_description"/>
			                                <field name="old_value_text"/>
			                                <field name="new_value_text"/>
			                            </tree>
			                        </field>
		                        </page>
		            	</notebook>
       				</sheet>
       			</form>
            </field>
        </record>

        <record id="view_vhr_erp_bonus_payment_line_tree" model="ir.ui.view">
            <field name="name">vhr.erp.bonus.payment.line.tree</field>
            <field name="model">vhr.erp.bonus.payment.line</field>
            <field name="arch" type="xml">
                <tree string="ERP Bonus Payment Line" version="7.0" create="0" edit="0" delete="0">
                   	<field name="bonus_payment_id"/>
                   	<field name="applicant_id"/>
                   	<field name="payment_time_id"/>                   	               	
                   	<field name="payment_date"/>
                   	<field name="payment_rate"/>
					<field name="payment_value"/>
					<field name="state" invisible="0"/>
					<field name="exclusion_id" invisible="1"/>				
					<button name="action_payment" states="draft" type="object" confirm="Are you sure you want to execute ?" icon="kanban-apply" string="Payment" class="oe_highlight"/>
					<button name="action_cancel" states="draft" type="object" confirm="Are you sure you want to execute ?" icon="gtk-cancel" string="Cancel" class="oe_highlight"/>
                </tree>
            </field>
        </record>
        
        <record id="view_vhr_erp_bonus_payment_line_search" model="ir.ui.view">
            <field name="name">vhr.erp.bonus.payment.line.search</field>
            <field name="model">vhr.erp.bonus.payment.line</field>
            <field name="arch" type="xml">
                <search string="Search">
      			 	<group expand="0" string="Group By">
                        <filter name="group_by_bonus_payment_id" string="Bonus"
                               context="{'group_by':'bonus_payment_id'}"/>
                        <filter name="group_by_payment_time_id" string="Payment Time"
                               context="{'group_by':'payment_time_id'}"/>
                        <filter name="group_by_payment_date" string="Month of paid"
                               context="{'group_by':'payment_date'}"/>
                        <filter name="group_by_payment_value" string="Payment value"
                               context="{'group_by':'payment_value'}"/>
                        <filter name="group_by_state" string="State"
                               context="{'group_by':'state'}"/>
                    </group>
                    <group expand="0" string="Filter">
                     <filter name="filter_cancel" string="Cancel"
                        	domain="[('state', '=', 'cancel')]"/>
                    	<filter name="filter_draft" string="Draft"
                        	domain="[('state', '=', 'draft')]"/>
                        <filter name="filter_payment" string="Paid"
                        	domain="[('state', '=', 'payment')]"/>
                        <filter name="filter_pay_in_month" string="Month of paid"
                        	domain="[('payment_date','&gt;',(context_today()-relativedelta(months=1)).strftime('%%Y-%%m-26')), ('payment_date','&lt;=',time.strftime('%%Y-%%m-25'))]"/>
                    </group>
                </search>
            </field>
        </record>

        <record model="ir.actions.act_window" id="act_vhr_erp_bonus_payment_line">
            <field name="name">ERP Payment Line</field>
            <field name="res_model">vhr.erp.bonus.payment.line</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="context">{'search_default_filter_pay_in_month': 1,'search_default_group_by_state': 1,
            	'rule_for_tree_form': True, 'attachment': False}
            </field>
            <field name="view_id" ref="view_vhr_erp_bonus_payment_line_tree"/>
            <field name="search_view_id" ref="view_vhr_erp_bonus_payment_line_search"/>
        </record>
    </data>
</openerp>