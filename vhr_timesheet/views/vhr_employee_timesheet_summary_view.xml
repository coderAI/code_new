<?xml version="1.0" ?>
<openerp>
    <data>

        <record model="ir.ui.view" id="view_vhr_employee_timesheet_summary_tree">
            <field name="name">vhr.employee.timesheet.summary.tree</field>
            <field name="model">vhr.employee.timesheet.summary</field>
            <field name="arch" type="xml">
                <tree string="Timesheet Summary" editable="top" create="false">
                    <field name="month" readonly="1"/>
                    <field name="year" readonly="1" remove_thousand_seps="1"/>
                    <field name="employee_code" readonly="1"/>
                    <field name="employee_login" readonly='1'/>
                    <field name="employee_name" readonly="1"/>
                    <field name="timesheet_id" readonly="1" options="{'no_open': True}"/>
                    <field name="working_days" readonly="1" options="{'show_zero': 1}"/>
                    <field name="total_hours_working" readonly="1" options="{'show_zero': 1}"
                           groups="vhr_base.hrs_group_system"/>
                    <field name="night_shift_allowance_hours" readonly="1" options="{'show_zero': 1}"/>

                    <field name="paid_days" options="{'show_zero': 1, 'save_readonly': 1}"/>
                    <field name="meal_days" options="{'show_zero': 1, 'save_readonly': 1}"/>
                    <field name="parking_days" options="{'show_zero': 1, 'save_readonly': 1}"/>

                    <field name="sick_leave_long" readonly="1" options="{'show_zero': 1}" string="Sick Leave (LONG)"/>
                    <field name="sick_leave_short" readonly="1" options="{'show_zero': 1}" string="Sick Leave (SHORT)"/>
                    <field name="maternity_leave" readonly="1" options="{'show_zero': 1}" string="Maternity Leave"/>
                    <field name="pregnancy_leave" readonly="1" options="{'show_zero': 1}"/>
                    <field name="relax_leave" readonly="1" options="{'show_zero': 1}"/>
                    <!--<field name="other_leave" readonly="1" options="{'show_zero': 1}"/>-->
                    <field name="total_unpaid_leave" readonly="1" options="{'show_zero': 1, 'save_readonly': 1}"
                           string="Total Unpaid Leave"/>
                    <field name="total_paid_leave" readonly="1" options="{'show_zero': 1, 'save_readonly': 1}"/>
                    <field name="state" readonly="1"/>

                    <field name="haft_day_paid_leave" readonly="1" options="{'show_zero': 1}" invisible="1"/>
                    <field name="adjust_haft_day_paid_leave" options="{'show_zero': 1}" string="Adjust" invisible="1"/>
                    <field name="paid_leave" readonly="1" options="{'show_zero': 1}" invisible="1"/>
                    
                    <field name="adjust_paid_leave" options="{'show_zero': 1}" string="Adjust" invisible="1"/>
                    <field name="haft_day_unpaid_leave" readonly="1" options="{'show_zero': 1}" invisible="1"/>
                    <field name="adjust_haft_day_unpaid_leave" options="{'show_zero': 1}" string="Adjust"  invisible="1"/>
                    <field name="unpaid_leave" readonly="1" options="{'show_zero': 1}" invisible="1"/>
                    <field name="adjust_unpaid_leave" options="{'show_zero': 1}" string="Adjust" invisible="1"/>
                    <field name="department_id" readonly="1" options="{'no_open': True}" invisible="1"/>
                    <field name="company_id" readonly="1" invisible="1"/>
                    <field name="name" invisible="1"/>
                    <field name="is_last_payment" readonly="1" />
                    <field name="termination_date" readonly="1" />                    
                </tree>
            </field>
        </record>

        <record model="ir.ui.view" id="view_vhr_employee_timesheet_summary_form">
            <field name="name">vhr.employee.timesheet.summary.form</field>
            <field name="model">vhr.employee.timesheet.summary</field>
            <field name="arch" type="xml">
                <form string="Timesheet Summary" create="false" edit="false">
                    <sheet>
                        <group col='4'>
                            <field name="name" invisible="1"/>
                            <field name="employee_code" readonly="1"/>
                            <field name="employee_id" options="{'no_create': True}"/>
                            <field name="company_id" invisible="1" options="{'no_create': True}"/>
                            <field name="month"/>
                            <field name="year" options="{'remove_thousand_seps': 1}"/>
                            <field name="department_id" readonly="1" options="{'no_open': True, 'no_create': True}"/>
                            <field name="timesheet_id" readonly="1" options="{'no_open': True, 'no_create': True}"/>
                        </group>
                        <group col='4'>
                            <field name="working_days"/>
                            <field name="night_shift_allowance_hours"/>
                            <field name="haft_day_paid_leave" invisible="1"/>
                            <field name="adjust_haft_day_paid_leave" string="Adjust" invisible="1"/>
                            <field name="paid_leave" invisible="1"/>
                            <field name="adjust_paid_leave" string="Adjust" invisible="1"/>
                            <field name="total_paid_leave"/>
                            <field name="haft_day_unpaid_leave" invisible="1"/>
                            <field name="adjust_haft_day_unpaid_leave" string="Adjust" invisible="1"/>
                            <field name="unpaid_leave" invisible="1"/>
                            <field name="adjust_unpaid_leave" string="Adjust" invisible="1"/>
                            <field name="total_unpaid_leave"/>
                            <field name="maternity_leave"/>
                            <field name="sick_leave_short"/>
                            <field name="sick_leave_long"/>
                            <field name="paid_days"/>
                            <field name="meal_days"/>
                            <field name="parking_days"/>
                        </group>

                        <notebook>
                            <page string="Logs" groups="vhr_base.hrs_group_system,vhr_timesheet.vhr_cb_timesheet">
                                <label string="*** Please press F5 to refresh the list of logs !" colspan="4"/>
                                <field name="audit_log_ids" mode="tree"
                                       widget="one2many_list" readonly="1" nolabel="1" colspan="4">
                                    <tree>
                                        <field name="timestamp" required="1" readonly="1"/>
                                        <field name="user_id" readonly="1"/>
                                        <field name="method" readonly="1"/>
                                        <field name="field_description"/>
                                        <field name="old_value_text"/>
                                        <field name="new_value_text"/>
                                    </tree>
                                </field>
                            </page>
                        </notebook>
                    </sheet>
                </form>
            </field>
        </record>

        <record model="ir.ui.view" id="view_vhr_employee_timesheet_summary_search">
            <field name="name">vhr.employee.timesheet.summary.search</field>
            <field name="model">vhr.employee.timesheet.summary</field>
            <field name="arch" type="xml">
                <search string="Search">
                	<group expand="0" string="Group By">
                        <filter name="group_employee" string="Employee" icon="terp-personal" domain="[]"
                                context="{'group_by':'employee_id'}"/>
                        <filter name="group_type" string="Year" icon="terp-stock_symbol-selection" domain="[]"
                                context="{'group_by':'year'}"/>
                        <filter string="Month" icon="terp-personal+" domain="[]"
                                context="{'group_by':'month','set_visible':True}"/>                        
                    </group>
                    <group expand="0" string="Filter by State">
                        <filter string="Save" name="saved"
                                domain="[('state', '=', 'saved')]"/>
                        <filter string="Unsaved" name="unsaved"
                                domain="[('state', '=', 'unsaved')]"/>
                    </group>
                    <group expand="0" string="Filter by Last Payment">
                        <filter string="True" name="last_payment"
                                domain="[('is_last_payment', '=', True)]"/>
                        <filter string="False" name="not_last_payment"
                                domain="[('is_last_payment', '=', False)]"/>
                    </group>
                    <group expand="0" string="Filter">
                        <filter string="Current Month" name="current_month"
                                domain="[('month','=',(context_today()).strftime('%%m')), ('year','=',(context_today()).strftime('%%Y'))]"/>
                        <field name="name" string="Employee"
                               filter_domain="['|','|',('employee_id.name','ilike',self),('employee_id.login','ilike',self),('employee_id.code','ilike',self)]"/>
                        <filter string="Timesheet" name="filter_timesheet" icon="STOCK_NEW"
                                domain="[]" context="{'filter_timesheet': True}"/>
                        <!--<field name="company_id"/>-->
                        <field name="month"/>
                        <field name="year"/>
                        <field name="department_id"/>
                        <field name="timesheet_id"/>
                        <field name="employee_id"/>
                    </group>
                </search>
            </field>
        </record>

        <record id="act_vhr_employee_timesheet_summary" model="ir.actions.act_window">
            <field name="name">Timesheet Summary</field>
            <field name="res_model">vhr.employee.timesheet.summary</field>
            <field name="type">ir.actions.act_window</field>
            <field name="view_type">form</field>
            <field name="context">{'search_default_current_month': 1, 'search_default_unsaved': 1,'rule_for_tree_form':True,'attachment':False}</field>
            <field name="view_mode">tree</field>
        </record>


        <record id="action_saved_summary" model="ir.actions.server">
            <field name="state">code</field>
            <field name="type">ir.actions.server</field>
            <field name="model_id" ref="vhr_timesheet.model_vhr_employee_timesheet_summary"/>
            <field name="code">action =self.btn_save(cr, uid, context)</field>
            <field name="condition">True</field>
            <field name="name">Saved</field>
        </record>

        <record model="ir.values" id="act_saved_summary_action">
            <field name="key2">client_action_multi</field>
            <field name="model">vhr.employee.timesheet.summary</field>
            <field name="name">Saved</field>
            <field name="value" eval="'ir.actions.server,%d'%action_saved_summary"/>
            <field name="object" eval="True"/>
        </record>
        
        <record id="action_open_log_employee_timesheet_summary_action" model="ir.actions.server">
            <field name="name">Logs</field>
            <field name="model_id" ref="model_vhr_employee_timesheet_summary"/>
            <field name="state">code</field>
            <field name="code">action = self.open_logs(cr, uid, context.get('active_ids', []), context=context)</field>
        </record>
        
        <record model="ir.values" id="action_open_log_employee_timesheet_summary">
            <field name="key2">client_action_multi</field>
            <field name="model">vhr.employee.timesheet.summary</field>
            <field name="name">Logs</field>
            <field name="value" eval="'ir.actions.server,%d'%action_open_log_employee_timesheet_summary_action"/>
            <field name="object" eval="True"/>
        </record>

    </data>
</openerp>
